# Tier 2 Summary Agent

The Tier 2 Summary Agent is responsible for generating concise, readable summaries from groups of related claims and sentences. These summaries are written as Markdown files in the vault and serve as a bridge between high-level concepts and the raw conversational data in Tier 1.

## Overview

The agent's primary workflow is as follows:

1.  **Retrieve Content Groups:** It identifies semantically related groups of claims and sentences from the knowledge graph.
2.  **Generate Summaries:** It uses a configured LLM to generate a coherent, bullet-point summary for each group.
3.  **Create Markdown Files:** It writes the generated summaries to Tier 2 Markdown files, including back-links and metadata.

## High-Quality Claim Selection

A critical function of the agent is to ensure that summaries are built only from reliable information. It uses the centralized evaluation threshold system to select high-quality claims for processing.

The selection process is as follows:

1.  **Seed Claim Retrieval:** The agent begins by fetching claims from the knowledge graph that have non-null scores for all three evaluation metrics (`entailed_score`, `coverage_score`, and `decontextualization_score`).
2.  **Quality Filtering:** Each of these claims is then filtered based on the `threshold.claim_quality` setting from the configuration. Only claims whose geometric mean quality score meets or exceeds this threshold are considered "high-quality."
3.  **Semantic Grouping:** These high-quality claims are then used as seeds to find semantically related content, forming the groups that will be summarized.

This ensures that Tier 2 summaries are generated exclusively from the most reliable and complete information available in the knowledge base.

## Output Format

Each summary block generated by the agent includes:
-   Bulleted list of summary points.
-   An `aclarai:id` and `ver=` number for version tracking.
-   An Obsidian `^anchor` for direct linking.
-   (Future) `[[Wikilinks]]` to related concepts.

## Integration

-   **Input:** Consumes `(:Claim)` and `(:Sentence)` nodes from the Neo4j graph.
-   **Output:** Writes `.md` files to the configured Tier 2 directory in the vault.
-   **Configuration:** All parameters, including the LLM model (`model.subject_summary`) and quality thresholds, are managed via `settings/aclarai.config.yaml`.